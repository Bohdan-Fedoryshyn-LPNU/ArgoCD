Умовно є 3 клатера kubernetes, з якихось причин у нас обмежений бюджет і ми не можемо дозволити +1 кластер собі. Або ці 3 кластери знаходяться в різних географічних місцях, 1 кластер - європа,  2 кластера - США, 3 кластер - азія.

всі 3 клакстреи зазвичай мають певні вільні ресурси, але інколи на кластерах росте навантаження на клієнтські застосунки, тому кластер починає загружатися майже в потолок.

Проте у нас є ще певний не кілєтьський софт, який потрібно деплоїти на якомусь з цих кластерів - наприклад Prometheus  або  ELK. Цей софт деплоїться лише на одному кластері і він обслуговує зразу всі 3 кластери.


Ідея полягає в тому, щоб зробити систему, яка дозволить прогнозувати збільшення навантаження на кластері ( наприклад prometheus бачить, що CPU на кластері > 80% або memory > 90% )
Відповідно на цьому кластері треба звільнити ресурси і бажано змігрувати наш ELK на інший кластер.

# Реалізація
Перший варіант - через Jenkins джобу, але я хочу задіяти Helm та ArgoCD, тому варіант виглядатиме так:

В мене буде Helm чарт з описом мого стороннього ПО - наприклад ELK ( але бажано щось не таке велике, тому це може бути Prometheus + Grafana )

Також є Helm чарт з описом об*єктів application для ArgoCD в якого є 3 values.yaml файли 
cluster1-values.yaml, cluster2-values.yaml, cluster3-values.yaml 
В кожному з values файлів - вказаний інший кластер для деплою нашого ПО ( ELK, чи чогось іншого )

prometheus + alartmanager моніторить CPU та Memorry на кластері, де розгорнуте наше ПО, в разі зростання навантаження на кластер - кидає веб-хук на мій python контейнер, який при отримані веб-хука робить git commit + git push з зміненим values.yaml для чарту Helm.

Далі ArgoCD отримує з git repo інформацію, що щось змінилося і передеплоює наше ПО, зносить його з старого кластеру та деплоїть на новому.
